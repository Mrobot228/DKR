# üì¶ Telegram –ë–æ—Ç –ü–æ—à—Ç–æ–≤–æ–≥–æ –°–µ—Ä–≤—ñ—Å—É

–ü–æ–≤–Ω–æ—Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–∏–π Telegram –±–æ—Ç –¥–ª—è –ø–æ—à—Ç–æ–≤–æ–≥–æ —Å–µ—Ä–≤—ñ—Å—É –∑ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—é –ø–æ—à—É–∫—É –≤—ñ–¥–¥—ñ–ª–µ–Ω—å, —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–∞–∫–ª–∞–¥–Ω–∏—Ö —Ç–∞ –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è –ø–æ—Å–∏–ª–æ–∫.

## üöÄ –ú–æ–∂–ª–∏–≤–æ—Å—Ç—ñ

### –û—Å–Ω–æ–≤–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó
- üîç **–ü–æ—à—É–∫ –≤—ñ–¥–¥—ñ–ª–µ–Ω—å** - –∑–Ω–∞—Ö–æ–¥–∏—Ç—å –Ω–∞–π–±–ª–∏–∂—á—ñ –≤—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è –∑–∞ –∞–¥—Ä–µ—Å–æ—é –∞–±–æ –≥–µ–æ–ª–æ–∫–∞—Ü—ñ—î—é
- üì¶ **–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–∞–∫–ª–∞–¥–Ω–∏—Ö** - –ø–æ–∫—Ä–æ–∫–æ–≤–∏–π –ø—Ä–æ—Ü–µ—Å —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–∞–∫–ª–∞–¥–Ω–æ—ó
- üìç **–í—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è –ø–æ—Å–∏–ª–æ–∫** - –ø–µ—Ä–µ–≥–ª—è–¥ —Å—Ç–∞—Ç—É—Å—É —Ç–∞ —ñ—Å—Ç–æ—Ä—ñ—ó –ø–æ—Å–∏–ª–∫–∏
- üìã **–ú–æ—ó –ø–æ—Å–∏–ª–∫–∏** - —Å–ø–∏—Å–æ–∫ –≤—Å—ñ—Ö –ø–æ—Å–∏–ª–æ–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- üí∞ **–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä** - —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –≤–∞—Ä—Ç–æ—Å—Ç—ñ –¥–æ—Å—Ç–∞–≤–∫–∏
- ‚ÑπÔ∏è **–Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è** - –¥–æ–≤—ñ–¥–∫–∞ –ø—Ä–æ —Å–µ—Ä–≤—ñ—Å

### –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó
- üìä –ü–µ—Ä–µ–≥–ª—è–¥ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- üìù –ó–º—ñ–Ω–∞ —Å—Ç–∞—Ç—É—Å—É –ø–æ—Å–∏–ª–æ–∫
- üè¢ –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –≤—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è–º–∏

## üõ† –¢–µ—Ö–Ω—ñ—á–Ω–∏–π —Å—Ç–µ–∫

- **Framework:** NestJS 10.x
- **–ú–æ–≤–∞:** TypeScript 5.x
- **Telegram –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∞:** nestjs-telegraf
- **–ë–∞–∑–∞ –¥–∞–Ω–∏—Ö:** PostgreSQL 15+
- **ORM:** TypeORM
- **–í–∞–ª—ñ–¥–∞—Ü—ñ—è:** class-validator, class-transformer

## üìã –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è

### 1. –ö–ª–æ–Ω—É–≤–∞–Ω–Ω—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é

```bash
cd post-office-bot
```

### 2. –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π

```bash
npm install
```

### 3. –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∑–º—ñ–Ω–Ω–∏—Ö –æ—Ç–æ—á–µ–Ω–Ω—è

–°—Ç–≤–æ—Ä—ñ—Ç—å —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤—ñ `env.example`:

```bash
cp env.example .env
```

–ó–∞–ø–æ–≤–Ω—ñ—Ç—å –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –∑–º—ñ–Ω–Ω—ñ:

```env
# Telegram Bot Token (–æ—Ç—Ä–∏–º–∞—Ç–∏ —á–µ—Ä–µ–∑ @BotFather)
BOT_TOKEN=your_telegram_bot_token_here

# PostgreSQL Database
DB_HOST=localhost
DB_PORT=5432
DB_USERNAME=postgres
DB_PASSWORD=your_password_here
DB_NAME=post_office_bot

# Google Maps API Key (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)
GOOGLE_MAPS_API_KEY=your_google_maps_api_key_here

# Admin Telegram IDs (—á–µ—Ä–µ–∑ –∫–æ–º—É)
ADMIN_IDS=123456789

# Server Port
PORT=3000

# Node Environment
NODE_ENV=development
```

### 4. –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –±–∞–∑–∏ –¥–∞–Ω–∏—Ö

```bash
# –°—Ç–≤–æ—Ä—ñ—Ç—å –±–∞–∑—É –¥–∞–Ω–∏—Ö PostgreSQL
createdb post_office_bot
```

### 5. –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞

```bash
# –†–µ–∂–∏–º —Ä–æ–∑—Ä–æ–±–∫–∏
npm run start:dev

# –ü—Ä–æ–¥–∞–∫—à–Ω
npm run build
npm run start:prod
```

## üì± –ö–æ–º–∞–Ω–¥–∏ –±–æ—Ç–∞

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å |
|---------|------|
| `/start` | –†–æ–∑–ø–æ—á–∞—Ç–∏ —Ä–æ–±–æ—Ç—É –∑ –±–æ—Ç–æ–º |
| `/find` | –ó–Ω–∞–π—Ç–∏ –Ω–∞–π–±–ª–∏–∂—á–µ –≤—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è |
| `/create` | –°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤—É –Ω–∞–∫–ª–∞–¥–Ω—É |
| `/track` | –í—ñ–¥—Å—Ç–µ–∂–∏—Ç–∏ –ø–æ—Å–∏–ª–∫—É |
| `/my` | –ú–æ—ó –ø–æ—Å–∏–ª–∫–∏ |
| `/calc` | –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –≤–∞—Ä—Ç–æ—Å—Ç—ñ |
| `/help` | –î–æ–≤—ñ–¥–∫–∞ |
| `/admin` | –ê–¥–º—ñ–Ω –ø–∞–Ω–µ–ª—å (–¥–ª—è –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—ñ–≤) |

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É

```
post-office-bot/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ main.ts                    # –¢–æ—á–∫–∞ –≤—Ö–æ–¥—É
‚îÇ   ‚îú‚îÄ‚îÄ app.module.ts              # –ì–æ–ª–æ–≤–Ω–∏–π –º–æ–¥—É–ª—å
‚îÇ   ‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ database.config.ts     # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è –ë–î
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ telegram.config.ts     # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è Telegram
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ app.config.ts          # –ó–∞–≥–∞–ª—å–Ω–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è
‚îÇ   ‚îú‚îÄ‚îÄ database/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ entities/              # TypeORM entities
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user.entity.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ post-office.entity.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ parcel.entity.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ parcel-status-history.entity.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ database.module.ts
‚îÇ   ‚îú‚îÄ‚îÄ modules/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ users/                 # –ú–æ–¥—É–ª—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ post-offices/          # –ú–æ–¥—É–ª—å –≤—ñ–¥–¥—ñ–ª–µ–Ω—å
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ parcels/               # –ú–æ–¥—É–ª—å –ø–æ—Å–∏–ª–æ–∫
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ maps/                  # –ú–æ–¥—É–ª—å –∫–∞—Ä—Ç/–≥–µ–æ–∫–æ–¥—É–≤–∞–Ω–Ω—è
‚îÇ   ‚îú‚îÄ‚îÄ telegram/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ telegram.module.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ telegram.update.ts     # –û–±—Ä–æ–±–Ω–∏–∫–∏ –∫–æ–º–∞–Ω–¥
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ scenes/                # –°—Ü–µ–Ω–∏ (–¥—ñ–∞–ª–æ–≥–∏)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ find-office.scene.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ create-parcel.scene.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ track-parcel.scene.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ calculator.scene.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ keyboards/             # –ö–ª–∞–≤—ñ–∞—Ç—É—Ä–∏
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ main.keyboard.ts
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ inline.keyboard.ts
‚îÇ   ‚îú‚îÄ‚îÄ common/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ utils/                 # –£—Ç–∏–ª—ñ—Ç–∏
‚îÇ   ‚îî‚îÄ‚îÄ constants/                 # –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏
‚îÇ       ‚îú‚îÄ‚îÄ parcel-status.enum.ts
‚îÇ       ‚îî‚îÄ‚îÄ messages.constant.ts
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ tsconfig.json
‚îî‚îÄ‚îÄ README.md
```

## üìä –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö

### –¢–∞–±–ª–∏—Ü—ñ

#### users
- `telegramId` - Telegram ID (PRIMARY KEY)
- `username` - –Ü–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- `firstName`, `lastName` - –Ü–º'—è —Ç–∞ –ø—Ä—ñ–∑–≤–∏—â–µ
- `phone` - –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É
- `isAdmin` - –ß–∏ —î –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º

#### post_offices
- `id` - ID –≤—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è
- `officeNumber` - –ù–æ–º–µ—Ä –≤—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è (—É–Ω—ñ–∫–∞–ª—å–Ω–∏–π)
- `city`, `address` - –ú—ñ—Å—Ç–æ —Ç–∞ –∞–¥—Ä–µ—Å–∞
- `latitude`, `longitude` - –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏
- `workingHours`, `phone` - –ì–æ–¥–∏–Ω–∏ —Ä–æ–±–æ—Ç–∏ —Ç–∞ —Ç–µ–ª–µ—Ñ–æ–Ω

#### parcels
- `id` - ID –ø–æ—Å–∏–ª–∫–∏
- `trackingNumber` - –ù–æ–º–µ—Ä –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è (XXXX-XXXX-XXXX)
- –î–∞–Ω—ñ –≤—ñ–¥–ø—Ä–∞–≤–Ω–∏–∫–∞ —Ç–∞ –æ—Ç—Ä–∏–º—É–≤–∞—á–∞
- `description`, `weight`, `declaredValue`
- `deliveryType` - –¢–∏–ø –¥–æ—Å—Ç–∞–≤–∫–∏ (standard/express)
- `currentStatus` - –ü–æ—Ç–æ—á–Ω–∏–π —Å—Ç–∞—Ç—É—Å

#### parcel_status_history
- `id` - ID –∑–∞–ø–∏—Å—É
- `parcelId` - ID –ø–æ—Å–∏–ª–∫–∏
- `status` - –°—Ç–∞—Ç—É—Å
- `comment`, `location` - –ö–æ–º–µ–Ω—Ç–∞—Ä —Ç–∞ –ª–æ–∫–∞—Ü—ñ—è
- `timestamp` - –ß–∞—Å –∑–º—ñ–Ω–∏

## üì¶ –°—Ç–∞—Ç—É—Å–∏ –ø–æ—Å–∏–ª–æ–∫

| –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å |
|--------|------|
| üìù awaiting_shipment | –û—á—ñ–∫—É—î –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–Ω—è |
| üì¶ accepted_at_origin | –ü—Ä–∏–π–Ω—è—Ç–æ –Ω–∞ –≤—ñ–¥–¥—ñ–ª–µ–Ω–Ω—ñ |
| üöö in_transit | –í –¥–æ—Ä–æ–∑—ñ |
| üèôÔ∏è arrived_at_destination | –ü—Ä–∏–±—É–ª–∞ –¥–æ –º—ñ—Å—Ç–∞ |
| üì¨ at_recipient_office | –ù–∞ –≤—ñ–¥–¥—ñ–ª–µ–Ω–Ω—ñ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è |
| ‚úÖ delivered | –í–∏–¥–∞–Ω–æ –æ—Ç—Ä–∏–º—É–≤–∞—á—É |
| ‚Ü©Ô∏è returned_to_sender | –ü–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –≤—ñ–¥–ø—Ä–∞–≤–Ω–∏–∫—É |

## üí∞ –¢–∞—Ä–∏—Ñ–∏

### –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞ –¥–æ—Å—Ç–∞–≤–∫–∞
- –ë–∞–∑–æ–≤–∞ —Ü—ñ–Ω–∞: 45 –≥—Ä–Ω
- –ó–∞ –∫–≥: 10 –≥—Ä–Ω
- –¢–µ—Ä–º—ñ–Ω: 3-5 –¥–Ω—ñ–≤

### –ï–∫—Å–ø—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∞
- –ë–∞–∑–æ–≤–∞ —Ü—ñ–Ω–∞: 85 –≥—Ä–Ω
- –ó–∞ –∫–≥: 20 –≥—Ä–Ω
- –¢–µ—Ä–º—ñ–Ω: 1-2 –¥–Ω—ñ

## üîß –†–æ–∑—Ä–æ–±–∫–∞

```bash
# –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º—ñ —Ä–æ–∑—Ä–æ–±–∫–∏
npm run start:dev

# –õ—ñ–Ω—Ç–∏–Ω–≥
npm run lint

# –§–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è
npm run format

# –ó–±—ñ—Ä–∫–∞
npm run build

# –¢–µ—Å—Ç–∏
npm run test
```

## üìù API –ö–∞—Ä—Ç

–ë–æ—Ç –ø—ñ–¥—Ç—Ä–∏–º—É—î –¥–≤–∞ —Å–µ—Ä–≤—ñ—Å–∏ –≥–µ–æ–∫–æ–¥—É–≤–∞–Ω–Ω—è:

1. **Google Maps API** (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ) - –ø–æ—Ç—Ä—ñ–±–µ–Ω API –∫–ª—é—á
2. **OpenStreetMap Nominatim** (–±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ) - –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º

–î–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è Google Maps –¥–æ–¥–∞–π—Ç–µ `GOOGLE_MAPS_API_KEY` –≤ `.env`.

## üîê –ë–µ–∑–ø–µ–∫–∞

- –¢–æ–∫–µ–Ω–∏ —Ç–∞ –ø–∞—Ä–æ–ª—ñ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è —É –∑–º—ñ–Ω–Ω–∏—Ö –æ—Ç–æ—á–µ–Ω–Ω—è
- –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –¥–æ—Å—Ç—É–ø–Ω—ñ –ª–∏—à–µ –¥–ª—è –≤–∫–∞–∑–∞–Ω–∏—Ö ID
- –í–∞–ª—ñ–¥–∞—Ü—ñ—è –≤—Å—ñ—Ö –≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö

## üìÑ –õ—ñ—Ü–µ–Ω–∑—ñ—è

MIT License

---

–†–æ–∑—Ä–æ–±–ª–µ–Ω–æ –∑ ‚ù§Ô∏è –¥–ª—è –ø–æ—à—Ç–æ–≤–∏—Ö —Å–µ—Ä–≤—ñ—Å—ñ–≤ –£–∫—Ä–∞—ó–Ω–∏





